{
  "queries": [
    {
      "name": "Domains",
      "category": "ðŸ§­ Compass: Information Gathering",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (d:Domain) RETURN d"
        }
      ]
    },
    {
      "name": "Domain Controllers",
      "category": "ðŸ§­ Compass: Information Gathering",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain Controllers Group...",
          "query": "MATCH (n:Group) WHERE n.objectid ENDS WITH \"-516\" RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p=(c:Computer)-[:MemberOf*1..]->(n:Group {name: $result}) RETURN p",
          "allowCollapse": false
        }
      ]
    },
    {
      "name": "High Value Targets",
      "category": "ðŸ§­ Compass: Information Gathering",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (d:Domain {name: $result})-[r:Contains*1..]->(h {highvalue: true}) RETURN p",
          "allowCollapse": false
        }
      ]
    },
    {
      "name": "Computers without LAPS",
      "category": "ðŸ§­ Compass: Information Gathering",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (d:Domain {name: $result})-[r:Contains*1..]->(c:Computer {haslaps: false}) RETURN p"
        }
      ]
    },
    {
      "name": "Owned Principals",
      "category": "ðŸ§­ Compass: Information Gathering",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (d:Domain)-[r:Contains*1..]->(o {owned: true}) RETURN p"
        }
      ]
    },
    {
      "name": "Sensitive Principals by Keywords",
      "category": "ðŸ§­ Compass: Information Gathering",
      "queryList": [
        {
          "final": true,
          "query": "UNWIND ['admin', 'amministratore', 'empfindlich', 'geheim', 'important', 'azure', 'MSOL', 'kennwort', 'pass', 'secret', 'sensib', 'sensitiv'] AS word MATCH (n) WHERE (toLower(n.name) CONTAINS toLower(word)) OR (toLower(n.description) CONTAINS toLower(word)) RETURN n"
        }
      ]
    },
    {
      "name": "Users with Password in AD",
      "category": "ðŸ§­ Compass: Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (d:Domain {name: $result})-[r:Contains*1..]->(u:User) WHERE u.userpassword IS NOT NULL RETURN p"
        }
      ]
    },
    {
      "name": "Users with \"Pass\" in AD Description",
      "category": "ðŸ§­ Compass: Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (d:Domain {name: $result})-[r:Contains*1..]->(u:User) WHERE u.description =~ '(?i).*pass.*' RETURN p"
        }
      ]
    },
    {
      "name": "Users with Password not Required",
      "category": "ðŸ§­ Compass: Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (d:Domain {name: $result})-[r:Contains*1..]->(u:User {passwordnotreqd: true}) RETURN p"
        }
      ]
    },
    {
      "name": "Users with Password never Expiring",
      "category": "ðŸ§­ Compass: Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (d:Domain {name: $result})-[r:Contains*1..]->(u:User {pwdneverexpires: True}) WHERE NOT u.name starts with 'KRBTGT' RETURN u"
        }
      ]
    },
    {
      "name": "Users with with Same Name in Different Domains",
      "category": "ðŸ§­ Compass: Accounts",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u1:User),(u2:User) WHERE split(u1.name,'@')[0] = split(u2.name,'@')[0] AND u1.domain <> u2.domain AND tointeger(split(u1.objectid,'-')[7]) >= 1000 RETURN u1"
        }
      ]
    },
    {
      "name": "Protected Users",
      "category": "ðŸ§­ Compass: Privileged Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Protected Users Group...",
          "query": "MATCH (n:Group) WHERE n.objectid ENDS WITH \"-525\" RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p=(u:User)-[:MemberOf*1..]->(n:Group {name: $result}) RETURN p"
        }
      ]
    },
    {
      "name": "AdminTo Relationships",
      "category": "ðŸ§­ Compass: Privileged Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p=(u {domain: $result})-[r:AdminTo]->(c:Computer) RETURN p"
        }
      ]
    },
    {
      "name": "Administrators",
      "category": "ðŸ§­ Compass: Privileged Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Administrators Group...",
          "query": "MATCH (n:Group) WHERE n.objectid ENDS WITH \"-544\" RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p=(u:User)-[:MemberOf*1..]->(n:Group {name: $result}) RETURN p"
        }
      ]
    },
    {
      "name": "Computers in Administrators",
      "category": "ðŸ§­ Compass: Privileged Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Administrators Group...",
          "query": "MATCH (n:Group) WHERE n.objectid ENDS WITH \"-544\" RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (c:Computer)-[r:MemberOf|HasSIDHistory*1..]->(g:Group {name: $result}) RETURN p",
          "endNode": "{}"
        }
      ]
    },
    {
      "name": "Computers Local Admin to Another Computer",
      "category": "ðŸ§­ Compass: Privileged Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (c1:Computer {domain: $result})-[r1:AdminTo]->(c2:Computer) RETURN p UNION ALL MATCH p = (c3:Computer {domain: $result})-[r2:MemberOf|HasSIDHistory*1..]->(g:Group)-[r3:AdminTo]->(c4:Computer) RETURN p"
        }
      ]
    },
    {
      "name": "Sessions of Administrators on non DCs Computers",
      "category": "ðŸ§­ Compass: Privileged Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (dc:Computer {domain: $result})-[r1:MemberOf*0..]->(g1:Group) WHERE g1.objectid =~ \"S-1-5-.*-516\" WITH COLLECT(dc) AS exclude MATCH p = (c:Computer {domain: $result})-[n:HasSession]->(u:User)-[r2:MemberOf*1..]->(g2:Group) WHERE NOT c IN exclude and g2.objectid ENDS WITH \"-544\" RETURN p"
        }
      ]
    },
    {
      "name": "DCSync Principals not Administrators",
      "category": "ðŸ§­ Compass: Privileged Accounts",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (admins {domain: $result})-[r1:MemberOf*0..]->(g1:Group) WHERE (g1.objectid =~ \"(?i)S-1-5-.*-512\") OR (g1.objectid =~ \"(?i)S-1-5-.*-516\") OR (g1.objectid =~ \"(?i)S-1-5-.*-518\") OR (g1.objectid =~ \"(?i)S-1-5-.*-519\") OR (g1.objectid =~ \"(?i)S-1-5-.*-520\") OR (g1.objectid =~ \"(?i)S-1-5-.*-544\") OR (g1.objectid =~ \"(?i)S-1-5-.*-548\") OR (g1.objectid =~ \"(?i)S-1-5-.*-549\") OR (g1.objectid =~ \"(?i)S-1-5-.*-551\") WITH COLLECT(admins) AS exclude MATCH p=(n1)-[:MemberOf|GetChanges*0..]->(u:Domain {name: $result}) WHERE NOT n1 IN exclude and (n1:Computer or n1:User) RETURN p"
        }
      ]
    },
    {
      "name": "AS-REP Roastable Principals",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (d:Domain {name: $result})-[r:Contains*1..]->(u {dontreqpreauth: true}) RETURN u"
        }
      ]
    },
    {
      "name": "Kerberoastable Principals",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (d:Domain {name: $result})-[r:Contains*1..]->(u {hasspn: true}) RETURN u"
        }
      ]
    },
    {
      "name": "Kerberoastable Administrators",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (admins {domain: $result})-[r1:MemberOf*0..]->(g1:Group) WHERE (g1.objectid =~ \"(?i)S-1-5-.*-512\") OR (g1.objectid =~ \"(?i)S-1-5-.*-516\") OR (g1.objectid =~ \"(?i)S-1-5-.*-518\") OR (g1.objectid =~ \"(?i)S-1-5-.*-519\") OR (g1.objectid =~ \"(?i)S-1-5-.*-520\") OR (g1.objectid =~ \"(?i)S-1-5-.*-544\") OR (g1.objectid =~ \"(?i)S-1-5-.*-548\") OR (g1.objectid =~ \"(?i)S-1-5-.*-549\") OR (g1.objectid =~ \"(?i)S-1-5-.*-551\") WITH COLLECT(admins) AS filter MATCH (d:Domain {name: $result})-[r:Contains*1..]->(u {hasspn: true}) WHERE u IN filter RETURN u"
        }
      ]
    },
    {
      "name": "Constrained Delegations",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (a {domain: $result})-[:AllowedToDelegate]->(c:Computer) RETURN p"
        }
      ]
    },
    {
      "name": "Constrained Delegations with Protocol Transition (trustedToAuth)",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (a {domain: $result, trustedtoauth: true})-[:AllowedToDelegate]->(c:Computer) RETURN p"
        }
      ]
    },
    {
      "name": "Computers Allowed to Delegate for Another Computer",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (c1:Computer {domain: $result})-[:AllowedToDelegate]->(c2:Computer) RETURN p"
        }
      ]
    },
    {
      "name": "Unconstrained Delegation Principals",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (dca)-[r:MemberOf*0..]->(g:Group) WHERE g.objectid =~ \"S-1-5-.*-516\" OR g.objectid =~ \".*-S-1-5-32-544\" WITH COLLECT(dca) AS exclude MATCH p = (d:Domain {name: $result})-[r:Contains*1..]->(uc {unconstraineddelegation: true}) WHERE (uc:User OR uc:Computer) AND NOT uc IN exclude RETURN p"
        }
      ]
    },
    {
      "name": "Resource-Based Constrained Delegation Principals",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p=(m)-[r:AllowedToAct]->(n) RETURN p"
        }
      ]
    },
    {
      "name": "Configure Resource-Based Constrained Delegation Permissions",
      "category": "ðŸ§­ Compass: Kerberos",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p=(m)-[r:AddAllowedToAct]->(n) RETURN p"
        }
      ]
    },
    {
      "name": "Interesting GPOs by Keyword",
      "category": "ðŸ§­ Compass: Group Policies",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "UNWIND [\"360totalsecurity\", \"access\", \"acronis\", \"adaware\", \"admin\", \"admin\", \"aegislab\", \"ahnlab\", \"alienvault\", \"altavista\", \"amsi\", \"anti-virus\", \"antivirus\", \"antiy\", \"apexone\", \"applock\", \"arcabit\", \"arcsight\", \"atm\", \"atp\", \"av\", \"avast\", \"avg\", \"avira\", \"baidu\", \"baiduspider\", \"bank\", \"barracuda\", \"bingbot\", \"bitdefender\", \"bluvector\", \"canary\", \"carbon\", \"carbonblack\", \"certificate\", \"check\", \"checkpoint\", \"citrix\", \"clamav\", \"code42\", \"comodo\", \"countercept\", \"countertack\", \"credential\", \"crowdstrike\", \"custom\", \"cyberark\", \"cybereason\", \"cylance\", \"cynet360\", \"cyren\", \"darktrace\", \"datadog\", \"defender\", \"druva\", \"drweb\", \"duckduckbot\", \"edr\", \"egambit\", \"emsisoft\", \"encase\", \"endgame\", \"ensilo\", \"escan\", \"eset\", \"exabot\", \"exception\", \"f-secure\", \"f5\", \"falcon\", \"fidelis\", \"fireeye\", \"firewall\", \"fix\", \"forcepoint\", \"forti\", \"fortigate\", \"fortil\", \"fortinet\", \"gdata\", \"gravityzone\", \"guard\", \"honey\", \"huntress\", \"identity\", \"ikarussecurity\", \"insight\", \"ivanti\", \"juniper\", \"k7antivirus\", \"k7computing\", \"kaspersky\", \"kingsoft\", \"kiosk\", \"laps\", \"lightcyber\", \"logging\", \"logrhythm\", \"lynx\", \"malwarebytes\", \"manageengine\", \"mass\", \"mcafee\", \"microsoft\", \"mj12bot\", \"msnbot\", \"nanoav\", \"nessus\", \"netwitness\", \"office365\", \"onedrive\", \"orion\", \"palo\", \"paloalto\", \"paloaltonetworks\", \"panda\", \"pass\", \"powershell\", \"proofpoint\", \"proxy\", \"qradar\", \"rdp\", \"rsa\", \"runasppl\", \"sandboxe\", \"sap\", \"scanner\", \"scanning\", \"sccm\", \"script\", \"secret\", \"secureage\", \"secureworks\", \"security\", \"sensitive\", \"sentinel\", \"sentinelone\", \"slurp\", \"smartcard\", \"sogou\", \"solarwinds\", \"sonicwall\", \"sophos\", \"splunk\", \"superantispyware\", \"symantec\", \"tachyon\", \"temporary\", \"tencent\", \"totaldefense\", \"transfer\", \"trapmine\", \"trend micro\", \"trendmicro\", \"trusteer\", \"trustlook\", \"uac\", \"vdi\", \"virusblokada\", \"virustotal\", \"virustotalcloud\", \"vpn\", \"vuln\", \"webroot\", \"whitelist\", \"wifi\", \"winrm\", \"workaround\", \"yubikey\", \"zillya\", \"zonealarm\", \"zscaler\"] as word match (n:GPO {domain: $result}) where toLower(n.name) CONTAINS toLower(word) RETURN n"
        }
      ]
    },
    {
      "name": "GPO Permissions of Non-Admin Principals",
      "category": "ðŸ§­ Compass: Group Policies",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (u1:user {domain: $result})-[r:MemberOf*1..]->(n:Group) WHERE (n.objectid =~ \"(?i)S-1-5-.*-512\") OR (n.objectid =~ \"(?i)S-1-5-.*-516\") OR (n.objectid =~ \"(?i)S-1-5-.*-518\") OR (n.objectid =~ \"(?i)S-1-5-.*-519\") OR (n.objectid =~ \"(?i)S-1-5-.*-520\") OR (n.objectid =~ \"(?i)S-1-5-.*-544\") OR (n.objectid =~ \"(?i)S-1-5-.*-548\") OR (n.objectid =~ \"(?i)S-1-5-.*-549\") OR (n.objectid =~ \"(?i)S-1-5-.*-551\") WITH COLLECT(u1) AS exclude MATCH p = (u2:User)-[r:AddMember|AddSelf|WriteSPN|AddKeyCredentialLink|AllExtendedRights|ForceChangePassword|GenericAll|GenericWrite|WriteDacl|WriteOwner|Owns]->(g:GPO) WHERE NOT u2 IN exclude RETURN p"
        }
      ]
    },
    {
      "name": "LAPS Passwords Readable by Non-Admin",
      "category": "ðŸ§­ Compass: DACL Abuse",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH (u1:user {domain: $result})-[r:MemberOf*1..]->(n:Group) WHERE (n.objectid =~ \"(?i)S-1-5-.*-512\") OR (n.objectid =~ \"(?i)S-1-5-.*-516\") OR (n.objectid =~ \"(?i)S-1-5-.*-518\") OR (n.objectid =~ \"(?i)S-1-5-.*-519\") OR (n.objectid =~ \"(?i)S-1-5-.*-520\") OR (n.objectid =~ \"(?i)S-1-5-.*-544\") OR (n.objectid =~ \"(?i)S-1-5-.*-548\") OR (n.objectid =~ \"(?i)S-1-5-.*-549\") OR (n.objectid =~ \"(?i)S-1-5-.*-551\") WITH COLLECT(u1) AS exclude MATCH p = (u2)-[r1:MemberOf*1..]->(g:Group)-[r2:GenericAll]->(t:Computer {haslaps:true}) WHERE NOT u2 IN exclude RETURN p"
        }
      ]
    },
    {
      "name": "LAPS Passwords Readable by Owned Principals",
      "category": "ðŸ§­ Compass: DACL Abuse",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (n {owned: true})-[r1:MemberOf*1..]->(g:Group)-[r2:GenericAll]->(t:Computer {haslaps:true}) RETURN p"
        }
      ]
    },
    {
      "name": "ACLs to Computers (excluding High Value Targets)",
      "category": "ðŸ§­ Compass: DACL Abuse",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p = (ucg {highvalue: false})-[r {isacl: true}]->(c:Computer {domain: $result}) WHERE (ucg:User OR ucg:Computer OR ucg:Group) RETURN p"
        }
      ]
    },
    {
      "name": "Group Delegated Outbound Object Control of Owned Principals",
      "category": "ðŸ§­ Compass: DACL Abuse",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (n {owned: true})-[r1:MemberOf*1..]->(g:Group)-[r2 {isacl: true}]->(t) RETURN p"
        }
      ]
    },
    {
      "name": "Dangerous Rights for Groups under Domain Users",
      "category": "ðŸ§­ Compass: DACL Abuse",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name DESC"
        },
        {
          "final": true,
          "query": "MATCH p=(m:Group {domain: $result})-[r1:MemberOf*1..]->(g:Group)-[:Owns|WriteDacl|GenericAll|WriteOwner|ExecuteDCOM|GenericWrite|AllowedToDelegate|ForceChangePassword]->(n) WHERE m.objectid ENDS WITH '-513' RETURN p"
        }
      ]
    },
    {
      "name": "Set DCSync Principals as High Value Targets",
      "category": "ðŸ§­ Compass: Adding High-Value Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (s)-[r:MemberOf|GetChanges*1..]->(d:Domain) WITH s, d MATCH (s)-[r:MemberOf|GetChangesAll*1..]->(d) WITH s, d MATCH p = (s)-[r:MemberOf|GetChanges|GetChangesAll*1..]->(d) WHERE s.highvalue = false SET s.highvalue = true, s.highvaluereason = 'DCSync Principal' RETURN p"
        }
      ]
    },
    {
      "name": "Set Unconstrained Delegation Principals as High Value Targets",
      "category": "ðŸ§­ Compass: Adding High-Value Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (d:Domain)-[r:Contains*1..]->(uc) WHERE (uc:User OR uc:Computer) AND uc.unconstraineddelegation = true AND uc.highvalue = false SET uc.highvalue = true, uc.highvaluereason = 'Unconstrained Delegation Principal' RETURN p"
        }
      ]
    },
    {
      "name": "Set Local Admin or Reset Password Principals as High Value Targets",
      "category": "ðŸ§­ Compass: Adding High-Value Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (a)-[r:AdminTo|ForceChangePassword]->(b) WHERE a.highvalue = false SET a.highvalue = true, a.highvaluereason = 'Local Admin or Reset Password Principal' RETURN a"
        }
      ]
    },
    {
      "name": "Set Principals with Privileges on Computers as High Value Targets",
      "category": "ðŸ§­ Compass: Adding High-Value Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (a)-[r:AllowedToDelegate|ExecuteDCOM|ForceChangePassword|GenericAll|GenericWrite|Owns|WriteDacl|WriteOwner]->(n:Computer) WHERE a.highvalue = false SET a.highvalue = true, a.highvaluereason = 'Principal with Privileges on Computers' RETURN a"
        }
      ]
    },
    {
      "name": "Set Principals with Privileges on Cert Publishers as High Value Targets",
      "category": "ðŸ§­ Compass: Adding High-Value Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (a)-[r:GenericAll|GenericWrite|MemberOf|Owns|WriteDacl|WriteOwner]->(g:Group) WHERE g.objectid =~ 'S-1-5-21-.*-517' AND a.highvalue = false SET a.highvalue = true, a.highvaluereason = 'Principal with Privileges on the Cert Publisher group' RETURN a"
        }
      ]
    },
    {
      "name": "Set Members of High Value Targets Groups as High Value Targets",
      "category": "ðŸ§­ Compass: Adding High-Value Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (a)-[r:MemberOf*1..]->(g:Group) WHERE a.highvalue = false AND g.highvalue = true SET a.highvalue = true, a.highvaluereason = 'Member of High Value Target Group' RETURN a"
        }
      ]
    },
    {
      "name": "Remove Inactive Users and Computers from High Value Targets",
      "category": "ðŸ§­ Compass: Adding High-Value Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (uc) WHERE uc.highvalue = true AND ((uc:User AND uc.enabled = false) OR (uc:Computer AND ((uc.enabled = false) OR (uc.lastlogon > 0 AND uc.lastlogon < (TIMESTAMP() / 1000 - 15552000)) OR (uc.lastlogontimestamp > 0 AND uc.lastlogontimestamp < (TIMESTAMP() / 1000 - 15552000))))) SET uc.highvalue = false, uc.nothighvaluereason = 'Inactive' RETURN uc"
        }
      ]
    },
    {
      "name": "Shortest Paths to Domain (including Computers)",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (d:Domain) RETURN d.name ORDER BY d.name ASC"
        },
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((uc)-[r:{}*1..]->(d:Domain {name: $result})) WHERE (uc:User OR uc:Computer) RETURN p",
          "endNode": "{}"
        }
      ]
    },
    {
      "name": "Shortest Paths to no LAPS",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((uc)-[r:{}*1..]->(c:Computer)) WHERE (uc:User OR uc:Computer) AND NOT uc = c AND c.haslaps = false RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths from Kerberoastable Users to Computers",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((u:User)-[r:{}*1..]->(c:Computer)) WHERE u.hasspn = true RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths from Kerberoastable Users to High Value Targets",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((u:User)-[r:{}*1..]->(h)) WHERE u.hasspn = true AND h.highvalue = true RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths from Owned Principals (including everything)",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((u:User)-[r:{}*1..]->(a)) WHERE u.owned = true AND u <> a RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths from Owned Principals to Domain",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (d:Domain) RETURN d.name ORDER BY d.name ASC"
        },
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((o)-[r:{}*1..]->(d:Domain)) WHERE o.owned = true AND d.name = $result RETURN p",
          "endNode": "{}"
        }
      ]
    },
    {
      "name": "Shortest Paths from Owned Principals to High Value Targets",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((o)-[r:{}*1..]->(h)) WHERE o.owned = true AND h.highvalue = true RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths from Owned Principals to no LAPS",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((o)-[r:{}*1..]->(c:Computer)) WHERE NOT o = c AND o.owned = true AND c.haslaps = false RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths from no Signing to Domain",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": false,
          "title": "Select a Domain...",
          "query": "MATCH (d:Domain) RETURN d.name ORDER BY d.name ASC"
        },
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((c:Computer)-[r:{}*1..]->(d:Domain)) WHERE c.hassigning = false AND d.name = $result RETURN p",
          "endNode": "{}"
        }
      ]
    },
    {
      "name": "Shortest Paths from no Signing to High Value Targets",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((c:Computer)-[r:{}*1..]->(h)) WHERE NOT c = h AND c.hassigning = false AND h.highvalue = true RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths from Domain Users and Domain Computers (including everything)",
      "category": "ðŸ§­ Compass: Shortest Paths",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = allShortestPaths((g:Group)-[r:{}*1..]->(a)) WHERE (g.objectid =~ $domain_users_id OR g.objectid =~ $domain_computers_id) AND g <> a RETURN p",
          "props": {
            "domain_users_id": "S-1-5-.*-513",
            "domain_computers_id": "S-1-5-.*-515"
          }
        }
      ]
    },
    {
      "name": "Find all Certificate Templates",
      "category": "ðŸ” Certipy: Certificates",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' RETURN n"
        }
      ]
    },
    {
      "name": "Find enabled Certificate Templates",
      "category": "ðŸ” Certipy: Certificates",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' and n.Enabled = true RETURN n"
        }
      ]
    },
    {
      "name": "Find Certificate Authorities",
      "category": "ðŸ” Certipy: Certificates",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Enrollment Service' RETURN n"
        }
      ]
    },
    {
      "name": "Show Enrollment Rights for Certificate Template",
      "category": "ðŸ” Certipy: Certificates",
      "queryList": [
        {
          "final": false,
          "title": "Select a Certificate Template...",
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' RETURN n.name"
        },
        {
          "final": true,
          "query": "MATCH p=(g)-[:Enroll|AutoEnroll]->(n:GPO {name:$result}) WHERE n.type = 'Certificate Template' return p",
          "allowCollapse": false
        }
      ]
    },
    {
      "name": "Show Rights for Certificate Authority",
      "category": "ðŸ” Certipy: Certificates",
      "queryList": [
        {
          "final": false,
          "title": "Select a Certificate Authority...",
          "query": "MATCH (n:GPO) WHERE n.type = 'Enrollment Service' RETURN n.name"
        },
        {
          "final": true,
          "query": "MATCH p=(g)-[:ManageCa|ManageCertificates|Auditor|Operator|Read|Enroll]->(n:GPO {name:$result}) return p",
          "allowCollapse": false
        }
      ]
    },
    {
      "name": "Find Misconfigured Certificate Templates (ESC1)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' and n.`Enrollee Supplies Subject` = true and n.`Client Authentication` = true and n.`Enabled` = true  RETURN n"
        }
      ]
    },
    {
      "name": "Shortest Paths to Misconfigured Certificate Templates from Owned Principals (ESC1)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=allShortestPaths((g {owned:true})-[*1..]->(n:GPO)) WHERE  g<>n and n.type = 'Certificate Template' and n.`Enrollee Supplies Subject` = true and n.`Client Authentication` = true and n.`Enabled` = true return p"
        }
      ]
    },
    {
      "name": "Find Misconfigured Certificate Templates (ESC2)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' and n.`Enabled` = true and (n.`Extended Key Usage` = [] or 'Any Purpose' IN n.`Extended Key Usage` or n.`Any Purpose` = True) RETURN n"
        }
      ]
    },
    {
      "name": "Shortest Paths to Misconfigured Certificate Templates from Owned Principals (ESC2)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=allShortestPaths((g {owned:true})-[*1..]->(n:GPO)) WHERE  g<>n and n.type = 'Certificate Template' and n.`Enabled` = true and (n.`Extended Key Usage` = [] or 'Any Purpose' IN n.`Extended Key Usage` or n.`Any Purpose` = True) RETURN p"
        }
      ]
    },
    {
      "name": "Find Enrollment Agent Templates (ESC3)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' and n.`Enabled` = true and (n.`Extended Key Usage` = [] or 'Any Purpose' IN n.`Extended Key Usage` or 'Certificate Request Agent' IN n.`Extended Key Usage` or n.`Any Purpose` = True) RETURN n"
        }
      ]
    },
    {
      "name": "Shortest Paths to Enrollment Agent Templates from Owned Principals (ESC3)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=allShortestPaths((g {owned:true})-[*1..]->(n:GPO)) WHERE  g<>n and n.type = 'Certificate Template' and n.`Enabled` = true and (n.`Extended Key Usage` = [] or 'Any Purpose' IN n.`Extended Key Usage` or n.`Any Purpose` = True or 'Certificate Request Agent' IN n.`Extended Key Usage`) RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths to Vulnerable Certificate Template Access Control (ESC4)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=shortestPath((g)-[:GenericAll|GenericWrite|Owns|WriteDacl|WriteOwner*1..]->(n:GPO)) WHERE  g<>n and n.type = 'Certificate Template' and n.`Enabled` = true RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths to Vulnerable Certificate Template Access Control from Owned Principals (ESC4)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=allShortestPaths((g {owned:true})-[r*1..]->(n:GPO)) WHERE g<>n and n.type = 'Certificate Template' and n.Enabled = true and NONE(x in relationships(p) WHERE type(x) = 'Enroll' or type(x) = 'AutoEnroll') return p"
        }
      ]
    },
    {
      "name": "Find Certificate Authorities with User Specified SAN (ESC6)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Enrollment Service' and n.`User Specified SAN` = 'Enabled' RETURN n"
        }
      ]
    },
    {
      "name": "Shortest Paths to Vulnerable Certificate Authority Access Control (ESC7)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=shortestPath((g)-[r:GenericAll|GenericWrite|Owns|WriteDacl|WriteOwner|ManageCa|ManageCertificates*1..]->(n:GPO)) WHERE  g<>n and n.type = 'Enrollment Service' RETURN p"
        }
      ]
    },
    {
      "name": "Shortest Paths to Vulnerable Certificate Authority Access Control from Owned Principals (ESC7)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=allShortestPaths((g {owned:true})-[*1..]->(n:GPO)) WHERE  g<>n and n.type = 'Enrollment Service' and NONE(x in relationships(p) WHERE type(x) = 'Enroll' or type(x) = 'AutoEnroll') RETURN p"
        }
      ]
    },
    {
      "name": "Find Certificate Authorities with HTTP Web Enrollment (ESC8)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Enrollment Service' and n.`Web Enrollment` = 'Enabled' RETURN n"
        }
      ]
    },
    {
      "name": "Find Unsecured Certificate Templates (ESC9)",
      "category": "ðŸ” Certipy: Domain Escalation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' and n.`Enrollee Supplies Subject` = true and n.`Client Authentication` = true and n.`Enabled` = true  RETURN n"
        }
      ]
    },
    {
      "name": "Find Unsecured Certificate Templates (ESC9)",
      "category": "ðŸ” Certipy: PKI",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:GPO) WHERE n.type = 'Certificate Template' and 'NoSecurityExtension' in n.`Enrollment Flag` and n.`Enabled` = true  RETURN n"
        }
      ]
    },
    {
      "name": "Shortest Paths to Unsecured Certificate Templates from Owned Principals (ESC9)",
      "category": "ðŸ” Certipy: PKI",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=allShortestPaths((g {owned:true})-[r*1..]->(n:GPO)) WHERE n.type = 'Certificate Template' and g<>n and 'NoSecurityExtension' in n.`Enrollment Flag` and n.`Enabled` = true and NONE(rel in r WHERE type(rel) in ['EnabledBy','Read','ManageCa','ManageCertificates']) return p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "List all owned users",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (m:User) WHERE m.owned=TRUE RETURN m"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "List all owned computers",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (m:Computer) WHERE m.owned=TRUE RETURN m"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "List all owned groups",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (m:Group) WHERE m.owned=TRUE RETURN m"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "List all High Valued Targets",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (m) WHERE m.highvalue=TRUE RETURN m"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "List the groups of all owned users",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (m:User) WHERE m.owned=TRUE WITH m MATCH p=(m)-[:MemberOf*1..]->(n:Group) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find the Shortest path to a high value target from an owned object",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=shortestPath((g {owned:true})-[*1..]->(n {highvalue:true})) WHERE  g<>n return p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find the Shortest path to a unconstrained delegation system from an owned object",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n) MATCH p=shortestPath((n)-[*1..]->(m:Computer {unconstraineddelegation: true})) WHERE NOT n=m AND n.owned = true RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all Kerberoastable Users",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:User)WHERE n.hasspn=true RETURN n",
          "allowCollapse": false
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find All Users with an SPN/Find all Kerberoastable Users with passwords last set less than 5 years ago",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u:User) WHERE u.hasspn=true AND u.pwdlastset < (datetime().epochseconds - (1825 * 86400)) AND NOT u.pwdlastset IN [-1.0, 0.0] RETURN u.name, u.pwdlastset order by u.pwdlastset "
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find Kerberoastable Users with a path to DA",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u:User {hasspn:true}) MATCH (g:Group) WHERE g.objectid ENDS WITH '-512' MATCH p = shortestPath( (u)-[*1..]->(g) ) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find machines Domain Users can RDP into",
      "queryList": [
        {
          "final": true,
          "query": "match p=(g:Group)-[:CanRDP]->(c:Computer) where g.objectid ENDS WITH '-513' return p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find what groups can RDP",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(m:Group)-[r:CanRDP]->(n:Computer) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find groups that can reset passwords (Warning: Heavy)",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(m:Group)-[r:ForceChangePassword]->(n:User) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find groups that have local admin rights (Warning: Heavy)",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(m:Group)-[r:AdminTo]->(n:Computer) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all users that have local admin rights",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(m:User)-[r:AdminTo]->(n:Computer) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all active Domain Admin sessions",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:User)-[:MemberOf]->(g:Group) WHERE g.objectid ENDS WITH '-512' MATCH p = (c:Computer)-[:HasSession]->(n) return p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all computers with Unconstrained Delegation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (c:Computer {unconstraineddelegation:true}) return c"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all computers with unsupported operating systems",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (H:Computer) WHERE H.operatingsystem = '.*(2000|2003|2008|xp|vista|7|me).*' RETURN H"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find users that logged in within the last 90 days",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u:User) WHERE u.lastlogon < (datetime().epochseconds - (90 * 86400)) and NOT u.lastlogon IN [-1.0, 0.0] RETURN u"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find users with passwords last set within the last 90 days",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u:User) WHERE u.pwdlastset < (datetime().epochseconds - (90 * 86400)) and NOT u.pwdlastset IN [-1.0, 0.0] RETURN u"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find constrained delegation",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(u:User)-[:AllowedToDelegate]->(c:Computer) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find computers that allow unconstrained delegation that ARENâ€™T domain controllers.",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (c1:Computer)-[:MemberOf*1..]->(g:Group) WHERE g.objectid ENDS WITH '-516' WITH COLLECT(c1.name) AS domainControllers MATCH (c2:Computer {unconstraineddelegation:true}) WHERE NOT c2.name IN domainControllers RETURN c2"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": " Return the name of every computer in the database where at least one SPN for the computer contains the string 'MSSQL'",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (c:Computer) WHERE ANY (x IN c.serviceprincipalnames WHERE toUpper(x) CONTAINS 'MSSQL') RETURN c"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "View all GPOs",
      "queryList": [
        {
          "final": true,
          "query": "Match (n:GPO) RETURN n"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "View all groups that contain the word 'admin'",
      "queryList": [
        {
          "final": true,
          "query": "Match (n:Group) WHERE n.name CONTAINS 'ADMIN' RETURN n"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find users that can be AS-REP roasted",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u:User {dontreqpreauth: true}) RETURN u"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find All Users with an SPN/Find all Kerberoastable Users with passwords last set > 5 years ago",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u:User) WHERE n.hasspn=true AND WHERE u.pwdlastset < (datetime().epochseconds - (1825 * 86400)) and NOT u.pwdlastset IN [-1.0, 0.0] RETURN u"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Show all high value target's groups",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(n:User)-[r:MemberOf*1..]->(m:Group {highvalue:true}) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find groups that contain both users and computers",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (c:Computer)-[r:MemberOf*1..]->(groupsWithComps:Group) WITH groupsWithComps MATCH (u:User)-[r:MemberOf*1..]->(groupsWithComps) RETURN DISTINCT(groupsWithComps) as groupsWithCompsAndUsers"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find Kerberoastable users who are members of high value groups",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (u:User)-[r:MemberOf*1..]->(g:Group) WHERE g.highvalue=true AND u.hasspn=true RETURN u"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find Kerberoastable users and where they are AdminTo",
      "queryList": [
        {
          "final": true,
          "query": "OPTIONAL MATCH (u1:User) WHERE u1.hasspn=true OPTIONAL MATCH (u1)-[r:AdminTo]->(c:Computer) RETURN u"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find computers with constrained delegation permissions and the corresponding targets where they allowed to delegate",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (c:Computer) WHERE c.allowedtodelegate IS NOT NULL RETURN c"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find if any domain user has interesting permissions against a GPO (Warning: Heavy)",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(u:User)-[r:AllExtendedRights|GenericAll|GenericWrite|Owns|WriteDacl|WriteOwner|GpLink*1..]->(g:GPO) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find if unprivileged users have rights to add members into groups",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:User {admincount:False}) MATCH p=allShortestPaths((n)-[r:AddMember*1..]->(m:Group)) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all users a part of the VPN group",
      "queryList": [
        {
          "final": true,
          "query": "Match p=(u:User)-[:MemberOf]->(g:Group) WHERE toUPPER (g.name) CONTAINS 'VPN' return p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find users that have never logged on and account is still active",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:User) WHERE n.lastlogontimestamp=-1.0 AND n.enabled=TRUE RETURN n "
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find an object in one domain that can do something to a foreign object",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(n)-[r]->(m) WHERE NOT n.domain = m.domain RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all sessions a user in a specific domain has",
      "requireNodeSelect": true,
      "queryList": [
        {
          "final": false,
          "title": "Select source domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name"
        },
        {
          "final": true,
          "query": "MATCH p=(m:Computer)-[r:HasSession]->(n:User {domain:{result}}) RETURN p",
          "startNode": "{}",
          "allowCollapse": false
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find an object from domain 'A' that can do anything to a foreign object",
      "requireNodeSelect": true,
      "queryList": [
        {
          "final": false,
          "title": "Select source domain...",
          "query": "MATCH (n:Domain) RETURN n.name ORDER BY n.name"
        },
        {
          "final": true,
          "query": "MATCH p=(n {domain:{result}})-[r]->(d) WHERE NOT d.domain=n.domain RETURN p",
          "startNode": "{}",
          "allowCollapse": false
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find All edges any owned user has on a computer",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=shortestPath((m:User)-[r*]->(b:Computer)) WHERE m.owned RETURN p"
        }
      ]
    },
	{
            "name": "List all kerberoastable users",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:User) WHERE n.hasspn=true RETURN n AS result ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List user CanRDP privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "match p=(u:User)-[:CanRDP]->(c:Computer) return p ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List group CanRDP privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "match p=(g:Group)-[:CanRDP]->(c:Computer) return p ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List all Unconstrained Delegation",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (c:Computer {unconstraineddelegation:true}) RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List all computers with unsupported OSs",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (H:Computer) WHERE H.operatingsystem =~ '.*(2000|2003|2008|xp|vista|7|me).*' RETURN H ORDER BY H.name"
                }
            ]
        },
        {
            "name": "List groups containing \"admin\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (g:Group) WHERE g.name =~ '.*((?i)admin|adm).*' RETURN g ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List users containing \"admin\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User) WHERE u.name =~ '.*((?i)admin|adm).*' RETURN u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to admin groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)admin|adm).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to admin groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)admin|adm).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to admin groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)admin|adm).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List groups containing \"sql\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (g:Group) WHERE g.name =~ '.*((?i)sql).*' RETURN g ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List users containing \"sql\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User) WHERE u.name =~ '.*((?i)sql).*' RETURN u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List computers containing \"sql\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (c:Computer) WHERE c.name =~ '.*((?i)sql).*' RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to SQL groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)SQL).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to SQL groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)SQL).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to SQL groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)SQL).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List users containing \"svc/service\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User) WHERE u.name =~ '.*((?i)svc|service).*' RETURN u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to service groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)service|svc).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to service groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)service|svc).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to service groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)service|svc).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List users containing \"web\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User) WHERE u.name =~ '.*((?i)web).*' RETURN u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List groups containing \"web\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (g:Group) WHERE g.name =~ '.*((?i)web).*' RETURN g ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List computers containing \"web\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (c:Computer) WHERE c.name =~ '.*((?i)web).*' RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to web groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)WEB).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to web groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)WEB).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to web groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)WEB).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List users containing \"dev\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User) WHERE u.name =~ '.*((?i)dev).*' RETURN u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List groups containing \"dev\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (g:Group) WHERE g.name =~ '.*((?i)dev).*' RETURN g ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List computers containing \"dev\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (c:Computer) WHERE c.name =~ '.*((?i)dev).*' RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List users containing \"prod\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User) WHERE u.name =~ '.*((?i)prod).*' RETURN u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List groups containing \"prod\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (g:Group) WHERE g.name =~ '.*((?i)prod).*' RETURN g ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List computers containing \"prod\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (c:Computer) WHERE c.name =~ '.*((?i)prod).*' RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List all Domain Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:Group) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-512\" WITH n MATCH p=(n)<-[r:MemberOf*1..]-(m) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to Domain Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-512\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to Domain Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-512\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to Domain Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-512\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all Enterprise Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:Group) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-519\" WITH n MATCH p=(n)<-[r:MemberOf*1..]-(m) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to Enterprise Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-519\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to Enterprise Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-519\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to Enterprise Admins",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-519\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all sessions",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(m:Computer)-[r:HasSession]->(n:User) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all AS-REP roastable users",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User {dontreqpreauth: true}) RETURN u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List all high-value groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:Group {highvalue:true}) RETURN m ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all members of high-value groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:MemberOf*1..]->(m:Group {highvalue:true}) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to high-value targets",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:User),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to high-value targets",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:Group),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to high-value targets",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:Computer),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to Exchange groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)EXCHANGE).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to Exchange groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)EXCHANGE).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to Exchange groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)EXCHANGE).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List user AdminTo privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(m:User)-[r:AdminTo]->(n:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List group AdminTo privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(m:Group)-[r:AdminTo]->(n:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List computer AdminTo privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(m:Computer)-[r:AdminTo]->(n:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List user ReadLAPSPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:ReadLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List group ReadLAPSPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:ReadLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List computer ReadLAPSPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:ReadLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List user SyncLAPSPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:SyncLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List group SyncLAPSPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:SyncLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List computer SyncLAPSPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:SyncLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List Domain Admin sessions",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:User)-[:MemberOf*1..]->(g:Group) WHERE g.objectid ENDS WITH '-512' MATCH p = (c:Computer)-[:HasSession]->(n) return p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List Enterprise Admin sessions",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:User)-[:MemberOf*1..]->(g:Group) WHERE g.objectid ENDS WITH '-519' MATCH p = (c:Computer)-[:HasSession]->(n) return p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all users",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:User) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all groups",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:Group) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:Computer) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all enabled computers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:Computer {enabled:TRUE}) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all disabled computers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:Computer {enabled:FALSE}) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all Domain Controllers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (n:Group) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-516\" WITH n MATCH p=(n)<-[r:MemberOf*1..]-(m) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all user shortest paths to Domain Controllers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-516\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all group shortest paths to Domain Controllers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-516\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computer shortest paths to Domain Controllers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer)-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-516\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List user Constrained Delegation",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(u:User)-[:AllowedToDelegate]->(c:Computer) RETURN p ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List group Constrained Delegation",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(g:Group)-[:AllowedToDelegate]->(c:Computer) RETURN p ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List computer Constrained Delegation",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(c1:Computer)-[:AllowedToDelegate]->(c2:Computer) RETURN p ORDER BY c1.name"
                }
            ]
        },
        {
            "name": "List all GPOs",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "Match (n:GPO) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all domains",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "Match (n:Domain) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all domain trusts",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Domain)-[r:TrustedBy]->(m:Domain) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List computers with LAPS enabled",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "Match (c:Computer) WHERE c.haslaps = true RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List computers with LAPS disabled",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "Match (c:Computer) WHERE c.haslaps = false RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List users with potential passwords in descriptions",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (u:User) WHERE u.description =~ '.*((?i)pass|pw|:).*' return u ORDER BY u.name"
                }
            ]
        },
        {
            "name": "List all high-value users",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:User {highvalue:true}) RETURN m ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all sensitive users",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:User {sensitive:true}) RETURN m ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all users with an admin count",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:User {admincount:true}) RETURN m ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all groups with an admin count",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:Group {admincount:true}) RETURN m ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all computers with an admin count",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (m:Computer {admincount:true}) RETURN m ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all user ReadGMSAPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:ReadGMSAPassword]->(m:User) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List all group ReadGMSAPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:ReadGMSAPassword]->(m:User) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List all computer ReadGMSAPassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:ReadGMSAPassword]->(m:User) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List all user DCSync privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:DCSync]->(m:Domain) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group DCSync privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:DCSync]->(m:Domain) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer DCSync privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:DCSync]->(m:Domain) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all DCSync privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n)-[r:DCSync]->(m:Domain) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user ForceChangePassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:ForceChangePassword]->(m:User) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group ForceChangePassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:ForceChangePassword]->(m:User) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer ForceChangePassword privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:ForceChangePassword]->(m:User) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user AddMember privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:AddMember]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group AddMember privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:AddMember]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer AddMember privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:AddMember]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user AddSelf privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:AddSelf]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group AddSelf privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:AddSelf]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer AddSelf privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:AddSelf]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user SQLAdmin privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:SQLAdmin]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group SQLAdmin privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:SQLAdmin]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer SQLAdmin privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:SQLAdmin]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user CanPSRemote privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:CanPSRemote]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group CanPSRemote privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:CanPSRemote]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer CanPSRemote privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:CanPSRemote]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user ExecuteDCOM privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:ExecuteDCOM]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group ExecuteDCOM privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:ExecuteDCOM]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer ExecuteDCOM privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:ExecuteDCOM]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user AllowedToAct privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:AllowedToAct]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group AllowedToAct privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:AllowedToAct]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer AllowedToAct privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:AllowedToAct]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user Owns privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:Owns]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group Owns privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:Owns]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer Owns privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:Owns]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user AllExtendedRights privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:AllExtendedRights]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group AllExtendedRights privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:AllExtendedRights]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer AllExtendedRights privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:AllExtendedRights]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user memberships",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:MemberOf]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group memberships",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:MemberOf]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer memberships",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:MemberOf]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user AddKeyCredentialLink privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:AddKeyCredentialLink]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group AddKeyCredentialLink privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:AddKeyCredentialLink]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer AddKeyCredentialLink privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:AddKeyCredentialLink]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user GenericAll privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:GenericAll]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group GenericAll privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:GenericAll]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer GenericAll privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:GenericAll]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user WriteDacl privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:WriteDacl]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group WriteDacl privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:WriteDacl]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer WriteDacl privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:WriteDacl]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user WriteOwner privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:WriteOwner]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group WriteOwner privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:WriteOwner]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer WriteOwner privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:WriteOwner]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all user GenericWrite privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r:GenericWrite]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all group GenericWrite privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r:GenericWrite]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all computer GenericWrite privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r:GenericWrite]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List groups containing \"svc/service\"",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (g:Group) WHERE g.name =~ '.*((?i)svc|service).*' RETURN g ORDER BY g.name"
                }
            ]
        },
        {
            "name": "List all OUs",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (o:OU) RETURN o ORDER BY o.name"
                }
            ]
        },
        {
            "name": "List all Containers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH (c:Container) RETURN c ORDER BY c.name"
                }
            ]
        },
        {
            "name": "List all Domains",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "Match (n:Domain) RETURN n ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all object control over OUs",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "match p=(n)-[r:Owns|AllExtendedRights|WriteDacl|GenericAll|WriteOwner|GenericWrite]->(o:OU) return p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all object control over Containers",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "match p=(n)-[r:Owns|AllExtendedRights|WriteDacl|GenericAll|WriteOwner|GenericWrite]->(c:Container) return p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all object control over GPOs",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "match p=(n)-[r:Owns|AllExtendedRights|WriteDacl|GenericAll|WriteOwner|GenericWrite]->(g:GPO) return p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all GP Links",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(g1)-[:GPLink]->(g2) RETURN p ORDER BY g1.name"
                }
            ]
        },
        {
            "name": "List all user privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:User)-[r]->(m) RETURN p ORDER BY TYPE(r)"
                }
            ]
        },
        {
            "name": "List all group privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Group)-[r]->(m) RETURN p ORDER BY TYPE(r)"
                }
            ]
        },
        {
            "name": "List all computer privileges",
            "category": "General",
            "queryList": [
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer)-[r]->(m) RETURN p ORDER BY TYPE(r)"
                }
            ]
        },
		{
            "name": "List this user's RDP privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "match p=(u:User {name: $result})-[:CanRDP]->(c:Computer) return p"
                }
            ]
        },
        {
            "name": "List this user's group-delegated RDP privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[:MemberOf]->(m:Group),(m)-[:CanRDP]->(c:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this user's AdminTo privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(m:User {name: $result})-[r:AdminTo]->(n:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this user's group-delegated AdminTo privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[:MemberOf]->(m:Group),(m)-[:AdminTo]->(c:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this user's sessions",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(m:Computer)-[r:HasSession]->(n:User {name: $result}) RETURN p"
                }
            ]
        },
        {
            "name": "List this user's ReadLAPSPassword privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:ReadLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this user's SyncLAPSPassword privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:SyncLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this user's ReadGMSAPassword privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:ReadGMSAPassword]->(m:User) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this user's Constrained Delegation privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(u:User {name: $result})-[:AllowedToDelegate]->(c:Computer) RETURN p"
                }
            ]
        },
        {
            "name": "List this user's ForceChangePassword privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:ForceChangePassword]->(m:User) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's AddMember privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:AddMember]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's AddSelf privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:AddSelf]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's SQLAdmin privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:SQLAdmin]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's CanPSRemote privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:CanPSRemote]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's ExecuteDCOM privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:ExecuteDCOM]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's AllowedToAct privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:AllowedToAct]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's Owns privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:Owns]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's AllExtendedRights privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:AllExtendedRights]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's AddKeyCredentialLink privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:AddKeyCredentialLink]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's GenericAll privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:GenericAll]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's WriteDacl privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:WriteDacl]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's WriteOwner privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:WriteOwner]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's GenericWrite privileges",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:GenericWrite]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this user's group memberships",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r:MemberOf]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List if this user's AS-REP roastable",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH (u:User {dontreqpreauth: true, name: $result}) RETURN u"
                }
            ]
        },
        {
            "name": "List if this user's kerberoastable",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH (n:User {name: $result, hasspn: true}) RETURN n AS result ORDER BY n.name"
                }
            ]
        },
		{
            "name": "List all privileges for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[r]->(m) RETURN p ORDER BY TYPE(r)"
                }
            ]
        },
        {
            "name": "List all group-delegated privileges for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:User {name: $result})-[:MemberOf]->(m:Group),(m)-[r]->(v) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to high-value targets for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH (m:User {name: $result}),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Domain Admins for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-512\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Enterprise Admins for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-519\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Domain Controllers for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-516\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Exchange groups for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)EXCHANGE).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },		
        {
            "name": "List all shortest paths to admin groups for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)admin|adm).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to sql groups for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)SQL).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to web groups for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)WEB).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to service groups for this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:User {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)service|svc).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to this user",
            "category": "User Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source user...",
					"query": "MATCH (u:User) RETURN u.name ORDER BY u.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m)-[r*1..]->(n:User {name: $result})) WHERE NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this group's RDP privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "match p=(g:Group {name: $result})-[:CanRDP]->(c:Computer) return p"
                }
            ]
        },
        {
            "name": "List this group's group-delegated RDP privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[:MemberOf]->(m:Group),(m)-[:CanRDP]->(c:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this group's AdminTo privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(m:Group {name: $result})-[r:AdminTo]->(n:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this group's group-delegated AdminTo privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[:MemberOf]->(m:Group),(m)-[:AdminTo]->(c:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this group's ReadLAPSPassword privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:ReadLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this group's SyncLAPSPassword privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:SyncLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this group's ReadGMSAPassword privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:ReadGMSAPassword]->(m:User) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this group's Constrained Delegation privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(g:Group {name: $result})-[:AllowedToDelegate]->(c:Computer) RETURN p"
                }
            ]
        },
        {
            "name": "List this group's ForceChangePassword privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:ForceChangePassword]->(m:User) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's AddMember privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:AddMember]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's AddSelf privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:AddSelf]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's SQLAdmin privileges",
            "category": "Group Specific",
            "queryList": [ 
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:SQLAdmin]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's CanPSRemote privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:CanPSRemote]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's ExecuteDCOM privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:ExecuteDCOM]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's AllowedToAct privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:AllowedToAct]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's Owns privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:Owns]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's AllExtendedRights privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:AllExtendedRights]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's AddKeyCredentialLink privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:AddKeyCredentialLink]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's GenericAll privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:GenericAll]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's WriteDacl privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:WriteDacl]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's WriteOwner privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:WriteOwner]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's GenericWrite privileges",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:GenericWrite]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's group memberships",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:MemberOf]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this group's members",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n)-[r:MemberOf]->(m {name: $result}) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all privileges for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[r:AdminTo|HasSession|ForceChangePassword|AddMember|AddSelf|CanPSRemote|ExecuteDCOM|SQLAdmin|AllowedToDelegate|GenericAll|GenericWrite|WriteDacl|Owns|AddKeyCredentialLink|ReadLAPSPassword|SyncLAPSPassword|ReadGMSAPassword|AllExtendedRights|AllowedToAct]->(m) RETURN p ORDER BY TYPE(r)"
                }
            ]
        },
        {
            "name": "List all group-delegated privileges for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Group {name: $result})-[:MemberOf]->(m:Group),(m)-[r]->(v) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to high-value targets for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH (m:Group {name: $result}),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Domain Admins for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-512\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Enterprise Admins for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-519\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Domain Controllers for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-516\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Exchange groups for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)EXCHANGE).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to admin groups for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)admin|adm).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to sql groups for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)SQL).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to web groups for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)WEB).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to service groups for this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Group {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)service|svc).*\" AND NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to this group",
            "category": "Group Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source group...",
					"query": "MATCH (g:Group) RETURN g.name ORDER BY g.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m)-[r*1..]->(n:Group {name: $result})) WHERE NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this computer's AdminTo privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(m:Computer {name: $result})-[r:AdminTo]->(n:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this computer's group-delegated AdminTo privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[:MemberOf]->(m:Group),(m)-[:AdminTo]->(c:Computer) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List this computer's ReadLAPSPassword privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:ReadLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this computer's SyncLAPSPassword privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:SyncLAPSPassword]->(m:Computer) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this computer's ReadGMSAPassword privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:ReadGMSAPassword]->(m:User) RETURN p ORDER by n.name"
                }
            ]
        },
        {
            "name": "List this computer's Constrained Delegation privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[:AllowedToDelegate]->(c:Computer) RETURN p"
                }
            ]
        },
        {
            "name": "List this computer's ForceChangePassword privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:ForceChangePassword]->(m:User) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's AddMember privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:AddMember]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's AddSelf privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:AddSelf]->(m:Group) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's SQLAdmin privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:SQLAdmin]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's CanPSRemote privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:CanPSRemote]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's ExecuteDCOM privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:ExecuteDCOM]->(m:Computer) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's AllowedToAct privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:AllowedToAct]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's Owns privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:Owns]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's AllExtendedRights privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:AllExtendedRights]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's AddKeyCredentialLink privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:AddKeyCredentialLink]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's GenericAll privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:GenericAll]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's WriteDacl privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:WriteDacl]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's WriteOwner privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:WriteOwner]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's GenericWrite privileges",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:GenericWrite]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List this computer's group memberships",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r:MemberOf]->(m) RETURN p ORDER BY n.name"
                }
            ]
        },
        {
            "name": "List all privileges for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[r]->(m) RETURN p ORDER BY TYPE(r)"
                }
            ]
        },
        {
            "name": "List all group-delegated privileges for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=(n:Computer {name: $result})-[:MemberOf]->(m:Group),(m)-[r]->(v) RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to high-value targets for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH (m:Computer {name: $result}),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Domain Admins for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-512\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Enterprise Admins for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-519\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Domain Controllers for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.objectid =~ \"(?i)S-1-5-21-.*-516\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") return p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to Exchange groups for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)EXCHANGE).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to admin groups for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)admin|adm).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to sql groups for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)SQL).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to web groups for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)WEB).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to service groups for this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m:Computer {name: $result})-[r*1..]->(n:Group)) WHERE n.name =~ \".*((?i)service|svc).*\" AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
        {
            "name": "List all shortest paths to this computer",
            "category": "Computer Specific",
            "queryList": [
				{
					"final": false,
					"title": "Select source computer...",
					"query": "MATCH (c:Computer) RETURN c.name ORDER BY c.name"
				},
                {
                    "final": true,
                    "query": "MATCH p=shortestPath((m)-[r*1..]->(n:Computer {name: $result})) WHERE NOT m=n AND NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") RETURN p ORDER BY m.name"
                }
            ]
        },
    {
      "category": "ðŸ’» Hausec",
      "name": "----------------------------------------AZURE QUERIES----------------------------------",
      "queryList": [
        {
          "final": true,
          "query": ""
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Return All Azure Users that are part of the 'Global Administrator' Role",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p =(n)-[r:AZGlobalAdmin*1..]->(m) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Return All On-Prem users with edges to Azure",
      "queryList": [
        {
          "final": true,
          "query": "MATCH  p=(m:User)-[r:AZResetPassword|AZOwns|AZUserAccessAdministrator|AZContributor|AZAddMembers|AZGlobalAdmin|AZVMContributor|AZOwnsAZAvereContributor]->(n) WHERE m.objectid CONTAINS 'S-1-5-21' RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all paths to an Azure VM",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (n)-[r]->(g:AZVM) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all paths to an Azure KeyVault",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (n)-[r]->(g:AZKeyVault) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Return All Azure Users and their Groups",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p=(m:AZUser)-[r:MemberOf]->(n) WHERE NOT m.objectid CONTAINS 'S-1-5' RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Return All Azure AD Groups that are synchronized with On-Premise AD",
      "queryList": [
        {
          "final": true,
          "query": "MATCH (n:Group) WHERE n.objectid CONTAINS 'S-1-5' AND n.azsyncid IS NOT NULL RETURN n"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all Privileged Service Principals",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (g:AZServicePrincipal)-[r]->(n) RETURN p"
        }
      ]
    },
    {
      "category": "ðŸ’» Hausec",
      "name": "Find all Owners of Azure Applications",
      "queryList": [
        {
          "final": true,
          "query": "MATCH p = (n)-[r:AZOwns]->(g:AZApp) RETURN p"
        }
      ]
    },
	{
			"name": "Return all Members of the 'Global Administrator' Role",
			"category": "Azure - General",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p =(n)-[r:AZGlobalAdmin*1..]->(m) RETURN p"
				}
			]
		},
		{
			"name": "Return all Members of High Privileged Roles",
			"category": "Azure - General",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p=(n)-[:AZHasRole|AZMemberOf*1..2]->(r:AZRole WHERE r.displayname =~ '(?i)Global Administrator|User Administrator|Cloud Application Administrator|Authentication Policy Administrator|Exchange Administrator|Helpdesk Administrator|PRIVILEGED AUTHENTICATION ADMINISTRATOR') RETURN p"
				}
			]
		},
		{
			"name": "Return all Members of High Privileged Roles that are synced from OnPrem AD",
			"category": "Azure - General",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p=(n WHERE n.onpremisesyncenabled = true)-[:AZHasRole|AZMemberOf*1..2]->(r:AZRole WHERE r.displayname =~ '(?i)Global Administrator|User Administrator|Cloud Application Administrator|Authentication Policy Administrator|Exchange Administrator|Helpdesk Administrator|PRIVILEGED AUTHENTICATION ADMINISTRATOR') RETURN p"
				}
			]
		},
        {
			"name": "Return all Azure Users that are synced from OnPrem AD",
			"category": "Azure - General",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (n:AZUser WHERE n.onpremisesyncenabled = true) RETURN n",
					"allowCollapse": true
				}
			]
		},
        {
			"name": "Return all Azure Groups that are synced from OnPrem AD",
			"category": "Azure - General",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (g:AZGroup {onpremsyncenabled: True}) RETURN g"
				}
			]
		},
        {
			"name": "Return all Owners of Azure Applications",
			"category": "Azure - General",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p = (n)-[r:AZOwns]->(g:AZApp) RETURN p"
				}
			]
		},
    {
			"name": "Find all Azure Users with a Path to High Value Targets",
			"category": "Azure - Paths",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (m:AZUser),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n RETURN p",
					"allowCollapse": true
				}
			]
		},
        {
			"name": "Find OnPrem synced Users with Paths to High Value Targets",
			"category": "Azure - Paths",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (m:AZUser WHERE m.onpremisesyncenabled = true),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find Azure Applications with Paths to High Value Targets",
			"category": "Azure - Paths",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (m:AZApp),(n {highvalue:true}),p=shortestPath((m)-[r*1..]->(n)) WHERE NONE (r IN relationships(p) WHERE type(r)= \"GetChanges\") AND NONE (r in relationships(p) WHERE type(r)=\"GetChangesAll\") AND NOT m=n RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find all Paths to Azure VMs",
			"category": "Azure - Paths",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p = (n)-[r]->(g:AZVM) RETURN p"
				}
			]
		},
        {
			"name": "Find shortest Path from Owned Azure Users to VMs",
			"category": "Azure - Paths",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (n:AZVM) MATCH p = shortestPath((m:AZUser{owned: true})-[*..]->(n)) RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find all Paths to Azure KeyVaults",
			"category": "Azure - Paths",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p = (n)-[r]->(g:AZKeyVault) RETURN p"
				}
			]
		},
		{
			"name": "Find all Paths to Azure KeyVaults from Owned Principals",
			"category": "Azure - Paths",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p = ({owned: true})-[r]->(g:AZKeyVault) RETURN p",
					"allowCollapse": true
				}
			]
		},
    {
			"name": "Return all Service Principals with MS Graph AZMGGrantAppRoles rights -> PrivEsc Path to Global Admin",
			"category": "Azure - MS Graph",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p=(n)-[r:AZMGGrantAppRoles]->(o:AZTenant) RETURN p",
					"allowCollapse": true
				}
			]
		},
        {
			"name": "Return all Service Principals with MS Graph App Role Assignments",
			"category": "Azure - MS Graph",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p=(m:AZServicePrincipal)-[r:AZMGAppRoleAssignment_ReadWrite_All|AZMGApplication_ReadWrite_All|AZMGDirectory_ReadWrite_All|AZMGGroupMember_ReadWrite_All|AZMGGroup_ReadWrite_All|AZMGRoleManagement_ReadWrite_Directory|AZMGServicePrincipalEndpoint_ReadWrite_All]->(n:AZServicePrincipal) RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Return all direct Controllers of MS Graph",
			"category": "Azure - MS Graph",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p = (n)-[r:AZAddOwner|AZAddSecret|AZAppAdmin|AZCloudAppAdmin|AZMGAddOwner|AZMGAddSecret|AZOwns]->(g:AZServicePrincipal {appdisplayname: \"Microsoft Graph\"}) RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find shortest Paths to MS Graph",
			"category": "Azure - MS Graph",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (n) WHERE NOT n.displayname=\"Microsoft Graph\" WITH n MATCH p = shortestPath((n)-[r*1..]->(g:AZServicePrincipal {appdisplayname: \"Microsoft Graph\"})) WHERE n<>g RETURN p",
					"allowCollapse": true
				}
			]
		},
    {
			"name": "Return all Azure Service Principals",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (sp:AZServicePrincipal) RETURN sp",
					"allowCollapse": true
				}
			]
		},
        {
			"name": "Find all VMs with a tied Managed Identity",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p=(:AZVM)-[:AZManagedIdentity]->(n) RETURN p",
					"allowCollapse": true
				}
			]
		},
        {
			"name": "Return all Azure Service Principals that are Managed Identities",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (sp:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'}) RETURN sp",
					"allowCollapse": true
				}
			]
		},
        {
			"name": "Find all Azure Privileged Service Principals",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p = (g:AZServicePrincipal)-[r]->(n) RETURN p"
				}
			]
		},
		{
			"name": "Find shortest Paths from Owned Azure Users to Azure Service Principals",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (u:AZUser {owned: true}), (m:AZServicePrincipal) MATCH p = shortestPath((u)-[*..]->(m)) RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find shortest Paths from Owned Azure Users to Azure Service Principals that are Managed Identities",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (u:AZUser {owned: true}), (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'}) MATCH p = shortestPath((u)-[*..]->(m)) RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find shortest Paths from all Azure Users to Azure Service Principals that are Managed Identities",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (u:AZUser), (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'}) MATCH p = shortestPath((u)-[*..]->(m)) RETURN p",
					"allowCollapse": true
				}
			]
		},
        {
			"name": "Find all Service Principals that are Managed Identities an have a Path to an Azure Key Vault",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'})-[*]->(kv:AZKeyVault) WITH collect(m) AS managedIdentities MATCH p = (n)-[r]->(kv:AZKeyVault) WHERE n IN managedIdentities RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find Paths from Managed Identities tied to a VM with a path to a Key Vault",
			"category": "Azure - Service Principals",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p1 = (:AZVM)-[:AZManagedIdentity]->(n) WITH collect(n) AS managedIdentities MATCH p2 = (m:AZServicePrincipal {serviceprincipaltype: 'ManagedIdentity'})-[*]->(kv:AZKeyVault) WHERE m IN managedIdentities RETURN p2",
					"allowCollapse": true
				}
			]
		},
    {
			"name": "Return all Users and Azure Users possibly related to AADConnect",
			"category": "Azure - AADConnect",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (u) WHERE (u:User OR u:AZUser) AND (u.name =~ '(?i)^MSOL_|.*AADConnect.*' OR u.userprincipalname =~ '(?i)^sync_.*') OPTIONAL MATCH (u)-[:HasSession]->(s:Session) RETURN u, s",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find all Sessions of possibly AADConnect related Accounts",
			"category": "Azure - AADConnect",
			"queryList": [
				{
					"final": true,
					"query": "MATCH p=(m:Computer)-[:HasSession]->(n) WHERE (n:User OR n:AZUser) AND ((n.name =~ '(?i)^MSOL_|.*AADConnect.*') OR (n.userPrincipalName =~ '(?i)^sync_.*')) RETURN p",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find all AADConnect Servers (extracted from the SYNC_ Account names)",
			"category": "Azure - AADConnect",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (n:AZUser) WHERE n.name =~ '(?i)^SYNC_(.*?)_(.*?)@.*' WITH n, split(n.name, '_')[1] AS computerNamePattern MATCH (c:Computer) WHERE c.name CONTAINS computerNamePattern RETURN c",
					"allowCollapse": true
				}
			]
		},
		{
			"name": "Find shortest Paths to AADConnect Servers from Owned Users",
			"category": "Azure - AADConnect",
			"queryList": [
				{
					"final": true,
					"query": "MATCH (n:AZUser) WHERE n.name =~ '(?i)^SYNC_(.*?)_(.*?)@.*' WITH n, split(n.name, '_')[1] AS computerNamePattern MATCH (c:Computer) WHERE c.name CONTAINS computerNamePattern WITH collect(c) AS computers MATCH p = shortestPath((u:User)-[*]-(c:Computer)) WHERE c IN computers AND length(p) > 0 AND u.owned = true RETURN u, p",
					"allowCollapse": true
				}
			]
		}
  ]
}
